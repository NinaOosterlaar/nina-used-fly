---
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import { SITE_TITLE } from "../consts";
import { getNumberOfEnrichedPosts } from '../utils/blog-db';
import { url } from "../utils/url";
import { resolveImageUrl } from "../utils/image";

// Get all blog posts sorted by publication date (newest first)
const allPosts =  await getNumberOfEnrichedPosts();

---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead title={`All Adventures - ${SITE_TITLE}`} description="Browse all of Nina's travel adventures and stories" />
	</head>
	<body>
		<Header />
		<main>
			<!-- Hero Section -->
			<div class="bg-gradient-to-br from-pink-50 via-white to-pink-25 py-16">
				<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
					<div class="text-center">
						<h1 class="title-font text-4xl md:text-5xl font-bold text-pink-400 mb-4">
							All Travels
						</h1>
						<p class="text-gray-600 max-w-2xl mx-auto text-lg">
							Every story, every journey, every adventure - all in one place
						</p>
						<div class="mt-6 text-sm text-pink-500">
							{allPosts.length} posts and counting...
						</div>
					</div>
				</div>
			</div>

			<!-- All Posts Grid -->
			<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
				<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
					{allPosts.map((post) => (
						<a 
							href={url(post.markdownData?.url || `/blog/post-${post.id}`)}
							class="post-card bg-white rounded-xl overflow-hidden shadow-md hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1 block"
						>
							<div class="h-48 overflow-hidden">
								{post.markdownData?.heroImage ? (
									<img
										src={resolveImageUrl(post.markdownData.heroImage)}
										alt={post.title}
										class="w-full h-full object-cover transition-transform duration-500 hover:scale-105"
									/>
								) : (
									<div class="w-full h-full bg-gradient-to-br from-pink-100 to-blue-100 flex items-center justify-center">
										<div class="text-center">
											<i class="fas fa-camera text-4xl text-pink-400 mb-2"></i>
											<p class="text-gray-600 text-sm">Photo coming soon</p>
										</div>
									</div>
								)}
							</div>
							<div class="p-6">
									<div class="flex items-center text-sm text-pink-400 mb-2">
										<i class="fas fa-map-marker-alt mr-1"></i>
										<span>{post.location}</span>
										{post.startDate && (
											<>
												<span class="mx-2">â€¢</span>
												<span>
													{new Date(post.startDate).toLocaleDateString('en-GB')}
													{post.endDate && (
														<> - {new Date(post.endDate).toLocaleDateString('en-GB')}</>
													)}
												</span>
											</>
										)}
									</div>
									<h3 class="title-font text-xl font-semibold text-gray-800 mb-3">
										{post.title.replace(/_/g, ' ')}
									</h3>
									<p class="text-gray-600 mb-4">
										{post.markdownData?.description || 'Read about my experiences and discoveries in this beautiful location in Belgium.'}
									</p>
									<div class="inline-flex items-center text-pink-500 hover:text-pink-700 font-medium transition-colors duration-200">
										Read more
										<i class="fas fa-arrow-right ml-2"></i>
									</div>
								</div>
						</a>
					))}
				</div>

				{allPosts.length === 0 && (
					<div class="text-center py-16">
						<i class="fas fa-compass text-6xl text-pink-300 mb-4"></i>
						<h3 class="text-2xl font-semibold text-gray-600 mb-2">No adventures yet</h3>
						<p class="text-gray-500">Check back soon for new travel stories!</p>
					</div>
				)}
			</div>
		</main>
		<Footer />

		<style>
			.line-clamp-2 {
				display: -webkit-box;
				-webkit-line-clamp: 2;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}
			.line-clamp-3 {
				display: -webkit-box;
				-webkit-line-clamp: 3;
				-webkit-box-orient: vertical;
				overflow: hidden;
			}
		</style>
	</body>
</html>
